image: composer:latest

before_script: [composer install]

test:pspec:
  before_script:
    - apk add autoconf build-base
    - pecl install xdebug
    - echo 'zend_extension=xdebug' > /usr/local/etc/php/php-cli.ini
    - echo 'memory_limit = 256M' > /usr/local/etc/php/php-cli.ini
    - composer install
  script: XDEBUG_MODE=coverage src/bin/pspec spec

test:examples:
  script: src/bin/pspec examples

lint:
  before_script:
    - cd tools/php-cs-fixer
    - composer install
    - cd ../..
  script:
    - tools/php-cs-fixer/vendor/bin/php-cs-fixer fix --dry-run --diff
